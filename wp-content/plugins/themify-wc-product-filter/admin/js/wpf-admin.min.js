'use strict';(function(b){b(document).ready(function(){b("body").delegate("a.wpf_lightbox","click",function(a){a.preventDefault();a.stopPropagation();var c=b(this);b.ajax({url:this,success:function(d){if(d){var m=c.attr("title"),l=c.data("class"),k=c.data("top");a.preventDefault();b(document).on("keyup",g);var f="wpf_"+Math.random().toString(36).substr(2,9);d='<div id="'+f+'" class="wpf_admin_lightbox wpf_interface"><div class="wpf_lightbox_title">'+m+'</div><a href="#" class="wpf_close_lightbox">\u00d7</a><div id="wpf_lightbox_container"><div class="wpf_lightbox_inner">'+
d+'</div></div></div><div class="wpf_overlay"></div>';b("body").append(d);k||(k=100);l&&b("#"+f).addClass(l);b.event.trigger("WPF.openlightbox",[a,f]);b("#"+f).nextAll(".wpf_overlay").show();b("#"+f).show().css("top",h()).animate({top:k},800);b("#"+f).find(".wpf_close_lightbox").click(e)}}})}).delegate(".wpf_delete","click",function(a){if(confirm(wpf_js.template_delete)){var c=b(this),d=c.closest("table");b.ajax({url:this,dataType:"json",beforeSend:function(){d.addClass("wpf_save")},complete:function(){d.removeClass("wpf_save")},
success:function(a){a&&"1"==a.status&&c.closest("tr").remove()}})}a.preventDefault()}).delegate(".open_media_uploader_image","click",function(a){var c=b(this).closest(".wpf_background_image"),d=wp.media({frame:"post",state:"insert",multiple:!1});d.open();d.on("insert",function(){var a=d.state().get("selection").first().toJSON();c.find("input").val(a.url);c.find("img").attr("src",a.url);c.addClass("has-image")});a.preventDefault()}).delegate(".remove-background","click",function(a){var c=b(this).closest(".wpf_background_image");
1==confirm("Remove background image?")&&(c.find("input").val(""),c.find("img").attr("src",""),c.removeClass("has-image"));a.preventDefault()})});var h=function(){var a=document;return Math.max(Math.max(a.body.scrollHeight,a.documentElement.scrollHeight),Math.max(a.body.offsetHeight,a.documentElement.offsetHeight),Math.max(a.body.clientHeight,a.documentElement.clientHeight))},g=function(a){27===a.keyCode&&(a.preventDefault(),e(a))},e=function(a){a.preventDefault();b(document).off("keyup",g);var c=
b(this).closest(".wpf_admin_lightbox");b.event.trigger("WPF.close_lightbox",this);c.animate({top:h()},800,function(){c.next(".wpf_overlay").remove();c.remove()})}})(jQuery);
function wpf_import(b,h){var g=b.attr("id").replace("plupload-upload-ui",""),e=[],a=b.closest("form"),c=a.find(".wpf_error");e=JSON.parse(JSON.stringify(h));e.browse_button=g;e.container=b.closest("form").attr("id");e.file_data_name=b.data("name")?b.data("name"):e.file_data_name;e.multipart_params={nonce:"",action:""};b.data("formats")&&(e.filters=b.data("formats"));var d=new plupload.Uploader(e);d.init();d.bind("FilesAdded",function(c,e){if(!b.data("confirm")||confirm(b.data("confirm")))d.settings.multipart_params.action=
a.find('input[name="action"]').val(),d.settings.multipart_params.nonce=a.find('input[name="nonce"]').val(),c.refresh(),c.start(),a.addClass("wpf_save")});d.bind("Error",function(b,d){a.removeClass("wpf_save");d.message&&c.text(d.message)});d.bind("FileUploaded",function(b,d,e){e?(b=JSON.parse(e.response),b.error?(a.removeClass("wpf_save"),c.text(b.error)):b.success&&(setTimeout(function(){a.removeClass("wpf_save")},1500),window.location.reload())):a.removeClass("wpf_save")})};
