'use strict';function themify_create_pluploader(b){var d=b.attr("id").replace("plupload-upload-ui",""),k=!1,l=!1,c=jQuery,a=JSON.parse(JSON.stringify(global_plupload_init));a.browse_button=d+a.browse_button;a.container=d+a.container;a.drop_element=d+a.drop_element;a.file_data_name=d+a.file_data_name;a.multipart_params.imgid=d;a.multipart_params._ajax_nonce=b.find(".ajaxnonceplu").attr("id").replace("ajaxnonceplu","");b.hasClass("add-preset")&&(k=!0,a.multipart_params.haspreset="haspreset");b.hasClass("add-preview")&&
(l=!0,a.multipart_params.haspreview="haspreview");b.hasClass("add-to-media")&&(a.multipart_params.tomedia="tomedia");b.data("postid")&&(a.multipart_params.topost=b.data("postid"));b.data("fields")&&(a.multipart_params.fields=b.data("fields"));b.data("featured")&&(a.multipart_params.featured=b.data("featured"));b.data("formats")&&(a.filters[0].extensions=b.data("formats"));a.multipart_params.action=b.data("action");a=new plupload.Uploader(a);a.bind("Init",function(a){});a.init();a.bind("FilesAdded",
function(a,d){if(!b.data("confirm")||confirm(b.data("confirm")))a.refresh(),a.start(),c(".tb_alert").addClass("busy").fadeIn(800)});a.bind("Error",function(a,b){c(".prompt-box .show-login").hide();c(".prompt-box .show-error").show();if(-600==b.code)var m=themify_lang.filesize_error,d=themify_lang.filesize_error_fix;0<c(".prompt-box .show-error").length&&(c(".prompt-box .show-error").html('<p class="prompt-error">'+m+"</p>"),d&&c(".prompt-box .show-error").append("<p>"+d+"</p>"));c(".overlay, .prompt-box").fadeIn(500)});
a.bind("FileUploaded",function(a,e,f){a=JSON.parse(f.response);var g="";g="200"!=f.status||a.error?"error":"done";c(".tb_alert").removeClass("busy").addClass(g).delay(800).fadeOut(800,function(){c(this).removeClass(g)});if(a.error)c(".prompt-box .show-login").hide(),c(".prompt-box .show-error").show(),0<c(".prompt-box .show-error").length&&(c(".prompt-box .show-error").html('<p class="prompt-error">'+a.error+"</p>"),c(".prompt-box .show-error").append("<p>"+themify_lang.enable_zip_upload+"</p>")),
c(".overlay, .prompt-box").fadeIn(500);else{c("#"+e.id).fadeOut();f=a.file;e=a.url;var h=a.type;"zip"===h||"rar"===h||"plain"===h?window.location=location.href.replace(location.hash,""):c("#"+d).val(e);"undefined"!==typeof a.thumb&&(themifyMediaLib.setPreviewIcon(b.closest(".themify_field, .themify_field_row"),a.thumb),c("body").trigger("themify_plupload_selected",[b,a]));k&&(c("#"+d).closest("fieldset").children(".preset").find("img").removeClass("selected"),a=e.replace(/^.*[\\\/]/,""),a=c('<a href="#" title="'+
a+'"><span title="'+f+'"></span><img src="'+e+'" alt="'+e+'" class="backgroundThumb selected" /></a>').css("display","inline-block"),c("#"+d).closest("fieldset").children(".preset").append(a));l&&c("#"+d+"-preview").attr("src",e)}})}jQuery(document).ready(function(b){var d=b(".plupload-upload-uic");0<d.length&&d.each(function(){themify_create_pluploader(b(this))})});
