var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,d,b){a instanceof String&&(a=String(a));for(var c=a.length,e=0;e<c;e++){var f=a[e];if(d.call(b,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,d,b){a!=Array.prototype&&a!=Object.prototype&&(a[d]=b.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};
$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(a,d,b,c){if(d){b=$jscomp.global;a=a.split(".");for(c=0;c<a.length-1;c++){var e=a[c];e in b||(b[e]={});b=b[e]}a=a[a.length-1];c=b[a];d=d(c);d!=c&&null!=d&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:d})}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,b){return $jscomp.findInternal(this,a,b).v}},"es6-impl","es3");var map,geo,$context,markers=[],poly;
function builderMapsProInit(){var a=jQuery("#markers",top_iframe).next("p.add_new").find("a");geo=new google.maps.Geocoder;a.text(builderMapsPro.labels.add_marker);builderMapsPro_make_preview()}function builderMapsPro_make_preview(){map=new google.maps.Map(top_iframe.getElementById("map-canvas"),{center:new google.maps.LatLng(-34.397,150.644)});poly=new google.maps.Polyline({});poly.setMap(map);builderMapsPro_update_map_preview();builderMapsPro_setup_markers()}
function builderMapsPro_setup_markers(){var a=jQuery,d=a("#markers",top_iframe).find(".tb_repeatable_field"),b=0;d.each(function(c){var e=a(this);e.data("marker_index",c);""!==e.find('[name="latlng"]').val()?d[c]=builderMapsPro_add_new_marker(e.find('[name="latlng"]').val(),e.find('[name="title"]').val(),e.find('[name="image"]').val(),c,e):(setTimeout(function(){d[c]=builderMapsPro_add_new_marker(e.find('[name="address"]').val(),e.find('[name="title"]').val(),e.find('[name="image"]').val(),c,e)},
350*b),b++)})}
function builderMapsPro_update_map_preview(){if("undefined"!==typeof geo){var a=jQuery;geo.geocode({address:a("#map_center",top_iframe).val()},function(a,c){c===google.maps.GeocoderStatus.OK&&map.setCenter(a[0].geometry.location)});var d={zoom:parseInt(a("#zoom_map",top_iframe).val()),mapTypeId:google.maps.MapTypeId[a("#type_map",top_iframe).val()],styles:builderMapsPro.styles[a("#style_map",top_iframe).val()],disableDefaultUI:"yes"===a("#disable_map_ui",top_iframe).val(),draggable:!1,scrollwheel:!1};
map.setOptions(d);poly.setOptions({geodesic:"yes"===a("#map_polyline_geodesic",top_iframe).val(),strokeColor:a("#map_polyline_color",top_iframe).val(),strokeOpacity:a("#map_polyline_color",top_iframe).parent().next(".color_opacity").val()||1,strokeWeight:a("#map_polyline_stroke",top_iframe).val(),visible:"yes"===a("#map_polyline",top_iframe).val()})}}
function builderMapsPro_resolve_address(a,d){if(null===a||""===a.trim())return!1;var b=a.match(/^([-+]?[1-8]?\d(\.\d+)?|90(\.0+)?),?\s*([-+]?180(\.0+)?|[-+]?((1[0-7]\d)|([1-9]?\d))(\.\d+)?)(,\d+z)?$/);jQuery.isArray(b)?d(new google.maps.LatLng(b[1],b[4])):geo.geocode({address:a},function(a,b){b===google.maps.GeocoderStatus.OK&&d(a[0].geometry.location);return null})}
function builderMapsPro_add_new_marker(a,d,b,c,e){if(null===a||""===a.trim())return null;builderMapsPro_resolve_address(a,function(a){poly&&poly.getPath().push(a);markers[c]=new google.maps.Marker({map:map,position:a,icon:b});if(""!==d.trim()){var f=new google.maps.InfoWindow({content:'<div class="maps-pro-content">'+d+"</div>"});google.maps.event.addListener(markers[c],"click",function(){f.open(map,markers[c])})}e.find('[name="latlng"]').val(a.lat()+","+a.lng())})}
function builderMapsPro_remove_marker(a){void 0!==markers[a]&&(markers[a].setMap(null),markers[a]=null)}
(function(a){jQuery(function(a){a("body").on("editing_module_option",function(a,c,e,d){"maps-pro"===c&&setTimeout(function(){"object"!==typeof google?Themify.LoadAsync("//maps.google.com/maps/api/js?v=3.exp&callback=builderMapsProInit&key="+builderMapsPro.key,!1,!1,!1,function(){return"object"===typeof google&&"object"===typeof google.maps}):builderMapsProInit()},1E3)});a("body",top_iframe).on("change","#map_center, #zoom_map, #type_map, #style_map, #disable_map_ui, #map_polyline, #map_polyline_geodesic, #map_polyline_stroke, #map_polyline_color",
function(b){b.isTrigger&&!a("#map_polyline_color",top_iframe).is(b.target)||builderMapsPro_update_map_preview()}).on("change","#markers .tb_lb_option_child",function(){var b=a(this).closest(".tb_repeatable_field"),c=void 0===b.data("marker_index")?markers.length:b.data("marker_index");builderMapsPro_remove_marker(c);markers[c]=builderMapsPro_add_new_marker(b.find('[name="address"]').val(),b.find('[name="title"]').val(),b.find('[name="image"]').val(),c,b)}).on("click","#markers .themify_builder_delete_row",
function(){var b=a(this).closest(".tb_repeatable_field").data("marker_index");builderMapsPro_remove_marker(b)})})})(window);
